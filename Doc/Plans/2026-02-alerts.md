Alerts and asides
===============================================================================

> [!NOTE]
> **Status**: DONE
>
> All GFM alert types and DocC aside kinds render as styled callouts in Up
> mode. Unit tests pass. Verified with `Doc/Examples/alerts.md`.


## Context

GFM alerts (`> [!NOTE]`, `> [!TIP]`, etc.) and DocC-style asides
(`> Note: ...`, `> Tip: ...`) are two conventions for callout blocks in
markdown. Both were rendered as plain `<blockquote>` elements. This change
detects both syntaxes in up mode and renders them as visually distinct callouts
with colored borders, icons, and titles.


## Detection

Two syntaxes, checked in order inside `visitBlockQuote`:

1. **GFM alerts** — The first paragraph's `plainText` is checked with
   `hasPrefix` against the five known tags: `[!NOTE]`, `[!TIP]`,
   `[!IMPORTANT]`, `[!WARNING]`, `[!CAUTION]`. Any text after the closing `]`
   on the same line is treated as content (not discarded). A `SoftBreak`
   immediately following the tag is skipped.

2. **DocC asides** — Uses swift-markdown's
   `Aside(blockQuote, tagRequirement: .requireAnyLengthTag)`. If it returns
   non-nil AND the kind matches a known `Aside.Kind` from `allCases`, treat it
   as an alert. All 24 predefined kinds are accepted.

GFM is checked first because the `[!...]` pattern is unambiguous. DocC is
checked second and validated against the known-kinds list to avoid false
positives on arbitrary `Word:` prefixes.


## Visual categories

Five visual styles. Every alert kind maps to one:

| Category  | Color  | GFM type  | DocC kinds                                                |
| --------- | ------ | --------- | --------------------------------------------------------- |
| note      | blue   | NOTE      | Note, Remark                                              |
| tip       | green  | TIP       | Tip, Experiment                                           |
| important | purple | IMPORTANT | Important, Attention                                      |
| warning   | amber  | WARNING   | Warning, Precondition, Postcondition, Requires, Invariant |
| caution   | red    | CAUTION   | Bug, Throws                                               |

All remaining DocC kinds (Author, Authors, Complexity, Copyright, Date,
MutatingVariant, NonMutatingVariant, Since, SeeAlso, ToDo, Version) map to
**note** (blue).


## Title text

- **GFM alerts** — Title is the type name: "Note", "Tip", "Important",
  "Warning", "Caution".
- **DocC asides** — Title is `Aside.Kind.displayName` (human-readable). For
  example, `> Precondition:` renders with the title "Precondition",
  `> See Also:` renders as "See Also", etc.


## HTML output

```html
<blockquote class="alert alert-note">
  <p class="alert-title"><svg …/>Note</p>
  <p>Content paragraph…</p>
</blockquote>
```

Using `<blockquote>` (not `<div>`) preserves base blockquote styles. The
`.alert` class overrides `color` back to `--text-color` (base blockquotes use
the muted `--blockquote-color`).


## Files changed

### `Core/Sources/Core/Rendering/UpHTMLVisitor.swift`

`visitBlockQuote` tries GFM detection, then DocC detection, then falls through
to the plain blockquote path.

Private helpers added:

- `AlertCategory` enum (`CaseIterable`, `String` raw value) — `cssClass`,
  `title`, `icon` (loaded from bundled SVG resources).
- `doccCategoryMap` — static dictionary mapping `Aside.Kind` raw values to
  `AlertCategory`. Explicit mapping for 12 kinds; remaining predefined kinds
  default to `.note`.
- `gfmAlertTags` — static array of `(String, AlertCategory)` tuples.
- `detectGFMAlert(_:)` — checks first paragraph's `plainText` for `[!TYPE]`
  prefix.
- `emitGFMAlertContent(_:category:)` — walks the first paragraph's inline
  children directly: strips the tag `Text` node, emits any trailing same-line
  content, skips a following `SoftBreak`, visits remaining inlines and
  subsequent block children.
- `detectDocCAlert(_:)` — uses `Aside`, validates against `allCases`, returns
  category + `displayName` + `aside.content`.
- `emitAlertOpen(_:)`, `emitAlertTitle(_:_:)` — HTML emission helpers.


### `Core/Sources/Core/Resources/alert-*.svg` (new, 5 files)

Octicon SVGs (MIT licensed) for the five categories: `alert-note.svg` (info),
`alert-tip.svg` (light-bulb), `alert-important.svg` (report),
`alert-warning.svg` (alert), `alert-caution.svg` (stop). 16×16,
`fill="currentColor"`.


### `Core/Sources/Core/Resources/mud-up.css`

Alert styles added after the blockquote rules:

- `--alert-*` custom properties on `.alert` (light defaults) with dark
  overrides inside `@media (prefers-color-scheme: dark)`. Themes can override
  any `--alert-*` variable in their `:root` blocks.
- `.alert` base: resets `color` to `--text-color`.
- `.alert-title`: flexbox row, `font-weight: 600`, icon sizing, gap.
- Five category rules for `border-left-color` and `.alert-title` color.

Color palette matches GitHub's alert colors.


### `Core/Tests/Core/UpHTMLVisitorTests.swift`

Three new tests: `gfmAlertNote`, `gfmAlertInlineContent`,
`plainBlockquoteUnchanged`.


### `Doc/AGENTS.md`

Added `alert-*.svg` to the Resources section.


## Files not modified

- **Theme CSS files** — Themes can optionally override `--alert-*` variables in
  the future.
- **`DownHTMLVisitor.swift`** — Down mode shows raw source; no changes.
- **`MarkdownParser.swift`** — No parser changes; detection is in the visitor.
- **`HTMLTemplate.swift`** — No changes; CSS is already bundled.
- **`mud.css`** — Alert styles are up-mode-only.


## Implementation notes

**`MarkupChildren.first` pitfall** — swift-markdown's `MarkupChildren` type
resolves `.first` to the `first(where:)` method reference rather than the
`Sequence.first` property. Casting the result with `as? Paragraph` silently
returns nil. Workaround: materialise to `Array` first, then index.

**GFM tag stripping** — The tag is always in a single `Text` node whose
`string` property starts with `[!TYPE]`. Content after the tag on the same line
(e.g. `> [!NOTE] Some text`) is preserved: the tag prefix is stripped from the
`Text` node's string and the remainder is emitted via `HTMLEscaping.escape`.

**DocC tag stripping** — `Aside.content` already has the tag removed. The
visitor simply iterates `aside.content` and calls `visit(block)` for each.


## Verification

Test document: `Doc/Examples/alerts.md` — covers all five GFM types, inline
content on the tag line, rich content (bold, code, links, code blocks, lists),
all 24 DocC aside kinds, and plain blockquotes that must not trigger alert
styling.

1. Open in Mud — verify each alert has correct colored border, icon, title, and
   content. Verify plain blockquotes are unchanged.
2. Toggle lighting — verify colors adapt to light and dark modes.
3. Toggle themes — verify alerts look consistent across all four themes.
4. Check down mode — verify raw source shows unchanged.
5. Test CLI output (`mud -u`) — verify alert HTML appears in CLI output.
